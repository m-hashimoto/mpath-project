--- ip_output.c.org	2005-02-24 17:01:11.000000000 +0900
+++ ip_output.c	2005-02-25 08:46:54.000000000 +0900
@@ -306,12 +306,15 @@
 		 * them, there is no way for one to update all its
 		 * routes when the MTU is changed.
 		 */
+		printf("ip_output: mtu calculate (case 1)\n");
 		if (ro->ro_rt->rt_rmx.rmx_mtu > ifp->if_mtu)
 			ro->ro_rt->rt_rmx.rmx_mtu = ifp->if_mtu;
 		mtu = ro->ro_rt->rt_rmx.rmx_mtu;
 	} else {
+		printf("ip_output: mtu calculate (case 2)\n");
 		mtu = ifp->if_mtu;
 	}
+	printf("ip_output: Calculated MTU[%d]\n",mtu);
 	if (IN_MULTICAST(ntohl(ip->ip_dst.s_addr))) {
 		m->m_flags |= M_MCAST;
 		/*
@@ -425,6 +428,9 @@
 	 * packet or packet fragments, unless ALTQ is enabled on the given
 	 * interface in which case packetdrop should be done by queueing.
 	 */
+	printf("ip_output: ifp[%p] ip[%p]\n",ifp,ip);
+	printf("ip_output: ifq_len[%d]\n",(int)ifp->if_snd.ifq_len);
+	printf("ip_output: ip_len[%d]\n",(int)ip->ip_len);
 #ifdef ALTQ
 	if ((!ALTQ_IS_ENABLED(&ifp->if_snd)) &&
 	    ((ifp->if_snd.ifq_len + ip->ip_len / mtu + 1) >=
@@ -434,6 +440,7 @@
 	    ifp->if_snd.ifq_maxlen)
 #endif /* ALTQ */
 	{
+		printf("ip_output: testprint 8\n");
 		error = ENOBUFS;
 		IPSTAT_INC(ips_odropped);
 		ifp->if_snd.ifq_drops += (ip->ip_len / ifp->if_mtu + 1);
@@ -445,6 +452,7 @@
 	 * verify user is allowed to send
 	 * such a packet.
 	 */
+	printf("ip_output: testprint 9\n");
 	if (isbroadcast) {
 		if ((ifp->if_flags & IFF_BROADCAST) == 0) {
 			error = EADDRNOTAVAIL;
@@ -465,6 +473,7 @@
 	}
 
 sendit:
+	printf("ip_output: testprint 10\n");
 #ifdef IPSEC
 	switch(ip_ipsec_output(&m, inp, &flags, &error, &ifp)) {
 	case 1:
@@ -557,6 +566,7 @@
 #endif /* IPFIREWALL_FORWARD */
 
 passout:
+	printf("ip_output: passout\n");
 	/* 127/8 must not appear on wire - RFC1122. */
 	if ((ntohl(ip->ip_dst.s_addr) >> IN_CLASSA_NSHIFT) == IN_LOOPBACKNET ||
 	    (ntohl(ip->ip_src.s_addr) >> IN_CLASSA_NSHIFT) == IN_LOOPBACKNET) {
@@ -661,6 +671,7 @@
 		IPSTAT_INC(ips_fragmented);
 
 done:
+	printf("ip_output: done\n");
 	if (ro == &iproute && ro->ro_rt && !nortfree) {
 		RTFREE(ro->ro_rt);
 	}
@@ -668,6 +679,7 @@
 		ifa_free(&ia->ia_ifa);
 	return (error);
 bad:
+	printf("ip_output: bad\n");
 	m_freem(m);
 	goto done;
 }
